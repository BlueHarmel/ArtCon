{% extends 'base.html' %}
{% load static %}
{% block content %}

    <!-- Start Content -->
    <div class="container py-5">
        <div class="d-flex row">
            <!-- Start Exhibition List -->
            <div class="col-lg-5 col-md-6 my-5">
                <h3 class="h3 fw-bold mb-2">추천 전시회 목록</h3>
                <!-- Start List of Recommendation-->
                <div class="row">
                  {% if exhibits %}
                  {% for exhibit in exhibits %}
                    <div class="card my-3">
                        <div class="row">
                            <div class="col-md-5 py-3">
                                <div class="card product-wap border-0">
                                    <div class="card rounded-0">
                                        <img class="card-img rounded-0 mapPageSize img-fluid" src="{{exhibit.img}}"/>
                                        <div class="card-img-overlay rounded-0 product-overlay d-flex align-items-center justify-content-center">
                                            <ul class="list-unstyled">
                                                <li><a class="btn btn-primary text-white mt-2" href="{% url 'exhibition' %}?exhibitID={{exhibit.id}}"><i class="far fa-eye"></i></a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-7">
                                <div class="card-body">
                                <p class="card-title fw-bold">{{exhibit.E_name}}</p>
                                <!--<p class="card-text fs-6">{{exhibit.summary}}</p>-->
                                <a class="nav-icon d-none d-lg-inline" href="#" data-bs-toggle="modal" data-bs-target="#templatemo_search">
                                <i class="fa-solid fa-location-dot" style="color: #000000;"></i>
                                        </a>
                                    <p class="fs-6"><i class="fas fa-regular fa-clock" style="margin-right: 3px;"></i>{{exhibit.time}}</p>
                                    <p class="fs-6"><i class="fas fa-map-marker-alt" style="margin-right: 3px;"></i>{{exhibit.L_name}}</p>
                                    <a href="{% url 'exhibition' %}?exhibitID={{exhibit.id}}" class="fs-6">자세히 보기</a>

                                </div>
                            </div>
                        </div>
                    </div>
                  {% endfor %}
                  {% endif %}
                </div>
                <!-- End List of Recommendation-->
            </div>
            <!-- End Exhibition List -->

            <!-- Start Map -->
            <div class="container col-lg-7 col-md-6 my-5">
                <div class="d-flex flex-row align-items-end mb-3">
                  <h1 class="h3 fw-bold">지도로 찾아보기</h1>
                  <button onclick="getLocation()" class="btn btn-primary mx-3">현재 위치 찾기</button>
                </div>                
                <div>                    
                  <div id="map" class="map border-secondary img-fluid" style="width: 800px; height:1000px;"></div>
                  <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=68869ffd346ee561ce8051bca3b782f7"></script>
                  <script>
                    // 좌표 얻어오기
                    // const boundsStr = bounds.toString();     
                    
                    const defaultPosition = new kakao.maps.LatLng(37.566535, 126.9779692);

                    const container = document.getElementById('map');
                    const options = { 
                        center: defaultPosition, 
                        level: 3
                    };
                    // 지도 생성
                    const map = new kakao.maps.Map(container, options);
                    window.onload = setMap(defaultPosition);
                    
                    function getLocation() {
                      if(navigator.geolocation) {
                          navigator.geolocation.getCurrentPosition(
                              function successCallback(position) {
                                  const x = position.coords.latitude;
                                  const y = position.coords.longitude;
                    
                              const options = { 
                                  center: new kakao.maps.LatLng(x, y), 
                                  level: 3
                              };
                              // 지도 생성
                              const map = new kakao.maps.Map(container, options);

                              // 지도 줌 컨트롤
                              const mapTypeControl = new kakao.maps.MapTypeControl();
                              map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
                              const zoomControl = new kakao.maps.ZoomControl();
                              map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
                              
                              /*
                              const positions = [
                                  {
                                      title: 'user',
                                      latlng: new kakao.maps.LatLng(userLocation.x, userLocation.y)
                                  },
                                  {
                                      title: '생태연못', 
                                      latlng: new kakao.maps.LatLng(33.450936, 126.569477)
                                  },
                                  {
                                      title: '텃밭', 
                                      latlng: new kakao.maps.LatLng(33.450879, 126.569940)
                                  },
                                  {
                                      title: '근린공원',
                                      latlng: new kakao.maps.LatLng(33.451393, 126.570738)
                                  }
                              ];

                              for (let i = 0; i < positions.length; i ++) {                            
                                  const marker = new kakao.maps.Marker({
                                      map: map,
                                      position: positions[i].latlng, 
                                      title : positions[i].title,
                                  });
                              }
                              */
                            }, function errorCallback() {
                                            defaultPosition;
                                        }
                                    )
                                }
                              }
                  marker.setMap(map);


                  </script>
                  <!--End Kakao Map-->
                </div>
            </div>
            <!-- End Map-->
        </div>

        <div class="container py-5">
            <div class="row py-1">
                <div class="row">
                    <div class="col text-center mt-2">
                        <button type="button" class="btn btn-outline-primary">1</button>
                        <!--<a href="/write.html"> 다음페이지 연결-->
                        <button type="button" class="btn btn-outline-primary">2</button>
                        <button type="button" class="btn btn-outline-primary">3</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Content -->


{% endblock %}